! function(r, e) {
    function t(r, e, t, o, a, n) {
        r = String(r);
        for (var i = 0, c = 0, f = r.length, u = "", d = 0; f > c;) {
            var s = r.charCodeAt(c);
            for (s = 256 > s ? t[s] : -1, i = (i << a) + s, d += a; d >= n;) {
                d -= n;
                var h = i >> d;
                u += o.charAt(h), i ^= h << d
            }++c
        }
        return !e && d > 0 && (u += o.charAt(i << n - d)), u
    }
    for (var o = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", a = "", n = [256], i = [256], c = 0, f = {
            encode: function(r) {
                var e = r.replace(/[\u0080-\u07ff]/g, function(r) {
                    var e = r.charCodeAt(0);
                    return String.fromCharCode(192 | e >> 6, 128 | 63 & e)
                }).replace(/[\u0800-\uffff]/g, function(r) {
                    var e = r.charCodeAt(0);
                    return String.fromCharCode(224 | e >> 12, 128 | e >> 6 & 63, 128 | 63 & e)
                });
                return e
            },
            decode: function(r) {
                var e = r.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g, function(r) {
                    var e = (15 & r.charCodeAt(0)) << 12 | (63 & r.charCodeAt(1)) << 6 | 63 & r.charCodeAt(2);
                    return String.fromCharCode(e)
                }).replace(/[\u00c0-\u00df][\u0080-\u00bf]/g, function(r) {
                    var e = (31 & r.charCodeAt(0)) << 6 | 63 & r.charCodeAt(1);
                    return String.fromCharCode(e)
                });
                return e
            }
        }; 256 > c;) {
        var u = String.fromCharCode(c);
        a += u, i[c] = c, n[c] = o.indexOf(u), ++c
    }
    var d = function(r, e, t) {
        return e ? d[r](e, t) : r ? null : this
    };
    d.btoa = d.encode = function(r, e) {
        return r = d.raw === !1 || d.utf8encode || e ? f.encode(r) : r, r = t(r, !1, i, o, 8, 6), r + "====".slice(r.length % 4 || 4)
    }, d.atob = d.decode = function(r, e) {
        r = String(r).split("=");
        var o = r.length;
        do --o, r[o] = t(r[o], !0, n, a, 6, 8); while (o > 0);
        return r = r.join(""), d.raw === !1 || d.utf8decode || e ? f.decode(r) : r
    }, e.Base64 = d
}(window, $),
function(r, e) {
    var t = function(r, e) {
            return r << e | r >>> 32 - e
        },
        o = function(r) {
            var e, t, o = "";
            for (e = 7; e >= 0; e--) t = r >>> 4 * e & 15, o += t.toString(16);
            return o
        },
        a = function(r) {
            r = r.replace(/\x0d\x0a/g, "\n");
            for (var e = "", t = 0; t < r.length; t++) {
                var o = r.charCodeAt(t);
                128 > o ? e += String.fromCharCode(o) : o > 127 && 2048 > o ? (e += String.fromCharCode(o >> 6 | 192), e += String.fromCharCode(63 & o | 128)) : (e += String.fromCharCode(o >> 12 | 224), e += String.fromCharCode(o >> 6 & 63 | 128), e += String.fromCharCode(63 & o | 128))
            }
            return e
        },
        n = function(r) {
            var e, n, i, c, f, u, d, s, h, l = new Array(80),
                g = 1732584193,
                p = 4023233417,
                C = 2562383102,
                v = 271733878,
                m = 3285377520;
            r = a(r);
            var w = r.length,
                b = new Array;
            for (n = 0; w - 3 > n; n += 4) i = r.charCodeAt(n) << 24 | r.charCodeAt(n + 1) << 16 | r.charCodeAt(n + 2) << 8 | r.charCodeAt(n + 3), b.push(i);
            switch (w % 4) {
                case 0:
                    n = 2147483648;
                    break;
                case 1:
                    n = r.charCodeAt(w - 1) << 24 | 8388608;
                    break;
                case 2:
                    n = r.charCodeAt(w - 2) << 24 | r.charCodeAt(w - 1) << 16 | 32768;
                    break;
                case 3:
                    n = r.charCodeAt(w - 3) << 24 | r.charCodeAt(w - 2) << 16 | r.charCodeAt(w - 1) << 8 | 128
            }
            for (b.push(n); b.length % 16 != 14;) b.push(0);
            for (b.push(w >>> 29), b.push(w << 3 & 4294967295), e = 0; e < b.length; e += 16) {
                for (n = 0; 16 > n; n++) l[n] = b[e + n];
                for (n = 16; 79 >= n; n++) l[n] = t(l[n - 3] ^ l[n - 8] ^ l[n - 14] ^ l[n - 16], 1);
                for (c = g, f = p, u = C, d = v, s = m, n = 0; 19 >= n; n++) h = t(c, 5) + (f & u | ~f & d) + s + l[n] + 1518500249 & 4294967295, s = d, d = u, u = t(f, 30), f = c, c = h;
                for (n = 20; 39 >= n; n++) h = t(c, 5) + (f ^ u ^ d) + s + l[n] + 1859775393 & 4294967295, s = d, d = u, u = t(f, 30), f = c, c = h;
                for (n = 40; 59 >= n; n++) h = t(c, 5) + (f & u | f & d | u & d) + s + l[n] + 2400959708 & 4294967295, s = d, d = u, u = t(f, 30), f = c, c = h;
                for (n = 60; 79 >= n; n++) h = t(c, 5) + (f ^ u ^ d) + s + l[n] + 3395469782 & 4294967295, s = d, d = u, u = t(f, 30), f = c, c = h;
                g = g + c & 4294967295, p = p + f & 4294967295, C = C + u & 4294967295, v = v + d & 4294967295, m = m + s & 4294967295
            }
            var h = o(g) + o(p) + o(C) + o(v) + o(m);
            return h.toLowerCase()
        };
    e.sha1 = n
}(window, $),
function(r) {
    "function" != typeof Object.assign && ! function() {
        Object.assign = function(r) {
            if (void 0 === r || null === r) throw new TypeError("Cannot convert undefined or null to object");
            for (var e = Object(r), t = 1; t < arguments.length; t++) {
                var o = arguments[t];
                if (void 0 !== o && null !== o)
                    for (var a in o) o.hasOwnProperty(a) && (e[a] = o[a])
            }
            return e
        }
    }(), Object.keys || (Object.keys = function() {
        var r = Object.prototype.hasOwnProperty,
            e = !{
                toString: null
            }.propertyIsEnumerable("toString"),
            t = ["toString", "toLocaleString", "valueOf", "hasOwnProperty", "isPrototypeOf", "propertyIsEnumerable", "constructor"],
            o = t.length;
        return function(a) {
            if ("object" != typeof a && "function" != typeof a || null === a) throw new TypeError("Object.keys called on non-object");
            var n = [];
            for (var i in a) r.call(a, i) && n.push(i);
            if (e)
                for (var c = 0; o > c; c++) r.call(a, t[c]) && n.push(t[c]);
            return n
        }
    }());
    var tipTimeout;
    var Ktip = {
        show: function(str, timeout) {
            if (!str) {
                return;
            }
            var $tipEl = $('#J_tip');
            if ($tipEl.length == 0) {
                $tipEl = $('<div id="J_tip" class="c-tip none">');
                $(document.body).append($tipEl);
            }
            window.clearTimeout(tipTimeout);
            $tipEl.html(str).css({
                'opacity': 0
            }).removeClass('none');
            $tipEl.animate({
                opacity: 1
            }, 500, 'ease-out');
            timeout = timeout || 2000;
            tipTimeout = setTimeout(function() {
                Ktip.hide();
            }, timeout);
        },
        hide: function() {
            var $tipEl = $('#J_tip');
            if ($tipEl.length) {
                $tipEl.animate({
                    opacity: 0
                }, 500, 'ease-out', function() {
                    $tipEl.addClass('none');
                });
            }
        }
    }
    var e = $.Base64,
        t = $.sha1,
        o = {
            hostname: function() {
                return "test.gateway.aidaojia.com"
                    // var e = "gateway.aidaojia.com";
                    // return ((location.hostname == "www.kmeila.com" || location.hostname == "m.kmeila.com") && location.port == "") ? e = "gateway.aidaojia.com" : e = "test.gateway.aidaojia.com", e
            }(),
            appSec: "0d36797c516a40dc9613401c1fcf5666",
            defaultDefault: {
                ttid: "120",
                appKey: "9754d853262f48d29e123fab9f34f040",
                appVersion: "1.0.0",
                osType: 1,
                osVersion: "7.1",
                hwId: "myhwid",
                mobileType: "iphone 5c"
            },
            merge: function(r) {
                r = r || {};
                var e = "";
                e += o.appSec;
                var t = Object.keys(r);
                t.sort().reverse();
                for (var a = 0, n = t.length; n > a; a++) e += t[a], e += r[t[a]];
                return e += o.appSec
            },
            h5SignAlgorithm: function(r) {
                var o = e.btoa(r, !0);
                return t(o)
            },
            getRequestUrl: function(r) {
                var e = "//" + o.hostname + "/gateway";
                e += "?";
                var t, a = [];
                for (var n in r) n = encodeURIComponent(n), t = r[n], t = t ? encodeURIComponent(t) : "", a.push(n + "=" + t);
                return e += a.join("&")
            }
        },
        a = {
            request: function(r) {
                r = r || {};
                var e = r.api,
                    t = r.apiVersion || "*",
                    a = r.data || {},
                    n = r.success,
                    i = r.fail,
                    c = r.error;
                if (a.formdata) {
                    var formdata = a.formdata;
                    delete a.formdata;
                }
                if (e) {
                    var f = Object.assign({}, o.defaultDefault, {
                            api: e,
                            apiVersion: t,
                            timestamp: (new Date).getTime()
                        }),
                        u = Object.assign({}, f, a)
                    var test = o.merge(u)
                    console.log(test)
                    d = o.h5SignAlgorithm(test);
                    f.sign = d;
                    var s = o.getRequestUrl(f);
                    if (formdata) {
                        h = formdata;
                        var xhr = new window.XMLHttpRequest();
                        xhr.onreadystatechange = function() {
                            if (xhr.readyState == 4) {
                                xhr.onreadystatechange = null;
                                var result, error = false
                                if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {
                                    result = xhr.responseText;
                                    try {
                                        result = JSON.parse(result);
                                        result = result || {};
                                        var e = result.code,
                                            t = result.msg,
                                            o = result.data || {};
                                        200 == e ? n(o) : Ktip.show(t || '请求出错，请重试')

                                    } catch (e) {
                                        error = e
                                    }

                                }

                            }
                        }
                        xhr.open('post', s, true);
                        xhr['withCredentials'] = true;
                        xhr.send(h);

                    } else {
                        h = encodeURIComponent(JSON.stringify(a));

                        $.ajax({
                            url: s,
                            crossDomain: !0,
                            contentType: "text/plain",
                            type: "post",
                            data: h,
                            dataType: "json",
                            xhrFields: {
                                withCredentials: true
                            },
                            success: function(r) {
                                r = r || {};
                                var e = r.code,
                                    t = r.msg,
                                    o = r.data || {};
                                200 == e ? n(o) : Ktip.show(t || '请求出错，请重试')
                            },
                            error: function() {
                                Ktip.show('网络请求失败，请稍后重试')
                            }
                        })
                    }
                }
            }
        };
    var localStorage = function() {
        var testdata = 'storagestoragestoragestoragestorage';
        var storage = window.localStorage;
        try {
            storage.setItem('testdata', testdata);
            storage.removeItem('testdata');
            return storage;
        } catch (e) {
            return null;
        }
    }();

    var kStorage = {
        onlystr: "kmllltid", //全局存储内容
        set: function(key, value) {
            if (localStorage) {
                return localStorage.setItem(key, value);
            }
        },
        get: function(key) {
            if (localStorage) {
                return localStorage.getItem(key);
            }
        },
        remove: function(key) {
            if (localStorage) {
                return localStorage.removeItem(key);
            }
        }
    }
    var utils = {
        formatDay: function(seconds, style) {
            var date = new Date(seconds * 1000)
            var year = date.getFullYear()
            var month = date.getMonth() + 1
            var day = date.getDate()
            if (style == 1) {
                var hour = date.getHours()
                var minute = date.getMinutes()
                var second = date.getSeconds()
                return [year, month, day].map(this.formatNumber).join('-') + ' ' + [hour, minute, second].map(this.formatNumber).join(':')
            }
            return [year, month, day].map(this.formatNumber).join('-')
        },
        formatNumber: function(n) {
            n = n.toString()
            return n[1] ? n : '0' + n
        },
        removewebp: function(imgUrl) {
            if (imgUrl) {
                return imgUrl.replace("?imageMogr2/format/webp", "")
            }
            return ""
        }
    }

    r.lib = r.lib || {}, r.lib.ktop = a, r.lib.kStorage = kStorage, r.lib.utils = utils, r.lib.Ktip = Ktip
}(window);